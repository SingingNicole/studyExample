<!DOCTYPE html>
<html>
<head>
<!-- 폼을 만들 때 주의 사항:
	무엇을 만들지 확인, html 작성, 스크립트 function, 스타일 -->
<meta charset="UTF-8">
<title>회원가입</title>
<script src="http://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>     
	$(function(){
		$("form").submit(function(){ // 전송 버튼을 누르면 시작. 에러가 없으면 대기.
		$("p.error").remove(); // 에러 초기화
		$("dl dd").removeClass("error"); // 에러가 난 상태에서 다시 입력하였을 때 기존의 error 메시지 삭제

		$(":text,textarea").filter(".validate").each(function(){ / text, textarea 객체 전부 중 validate 클래스인 경우
			$(this).filter(".required").each(function(){ // 빈 문자열 앞에 !가 붙으면 false를 의미.
				if ($(this).val() == "") {
					$(this).parent().prepend("<p class='error'>필수 입력 항목입니다</p>");
					// input 태그의 경우 자식을 가질 수 없기 때문에 부모 태그를 찾고 prepend 형식으로 내용을 추가한다.
				}
			});

			$(this).filter(".number").each(function(){ // 입력된 값이 number인지 체크 / validate이면서 number 클래스인 경우
				if (isNaN($(this).val())) { // NaN: not a Number. 숫자 여부 체크. 숫자가 아니라면 true
					$(this).parent().prepend("<p class='error'>우편번호는 숫자만 입력 가능합니다.</p>");
				}
			});

			
			$(this).filter(".mail").each(function(){ // 메일 어드레스가 유효한 양식인지 체크
				if ($(this).val() && !$(this).val().match(/.+@.+\..+/g)) {
					$(this).parent().prepend("<p class='error'>메일 어드레스 형식이 잘못되었습니다.</p>");
					// input 태그의 경우 자식을 가질 수 없기 때문에 부모 태그를 찾고 prepend 형식으로 내용을 추가한다.
				}
			});

			$(this).filter(".mail_check").each(function(){ // 메일 어드레스 2차 확인
				if ($(this).val() && $(this).val()!=$("input[name="+$(this).attr("name").replace(/^(.+)_check$/, "$1")+"]").val()) {
				/* mail_chck 분석
					- mail_check
					- (.+): 그루핑, 한 개 이상
						=> mail이라는 문자열을 $1d으로 그루핑하였다.
					- $("input[name=mail").val(): 메일에 입력한 값을 뽑아낸다.
				*/	
					$(this).parent().prepend("<p class='error'>메일 주소가 일치하지 않습니다.</p>");
				}
			});
		});
		
		$(":radio").filter(".validate").each(function(){ //라디오 버튼의 선택 여부 체크
			$(this).filter(".required").each(function(){
				if ($(":radio[name=" + $(this).attr("name") + "]:checked").length == 0) { // checked 된 배열의 길이가 0 = 선택되지 않음. 
					$(this).parent().prepend("<p class='error'>선택해 주세요</p>");
				}
			});
		});
		
		$(".checkboxRequired").each(function(){ // checkboxRequired 안에 있는 체크박스들의 체크 여부 확인
			if ($(":checkbox:checked", this).length == 0) { // checked된 체크박스를 배열에 저장하여 길이로 체크 여부 확인.
				// this와 다른 요소를 같이 사용할 때는 ,로 구분하고 this를 사용함.
				$(this).prepend("<p class='error'>하나 이상의 선택지에 체크해 주세요.</p>");
			}
		});
		
		$(".validate.add_text").each(function(){ // 기타 항목에 체크했을 경우 내용을 입력했는지 확인.
			if ($(this).is(":checked") && $("input[name="+$(this).attr("name").replace(/^(.+)$/, "$1_text")+"]").val() == "") { // 그 외의 항목이 공백인 경우.
				$(this).parent().prepend("<p class='error'>기타 항목을 입력해 주세요.</p>");
			}
		});
		/* if분석
			- "input[name=" , $(this).attr("name")=> "etc"
			-	"etc".replace(/^(.+)$/,"$1_text")
				+"]") => "etc_text"인 문자열로 바뀜.
				=> input[name="etc_text"]
		*/
		if($("p.error").length > 0){ // 에러 처리, error가 하나 이상 존재할 경우
				$('html,body').animate({ scrollTop: $("p.error:first").offset().top-40 }, 'slow');
					// :first = 문서 상의 해당 태그 중 가장 첫 번재 태그를 찾아간다.
					// .offset() = 문서의 위치를 잡는다.
					// 'slow' = 애니메이션의 속도 설정.
				$("p.error").parent().addClass("error"); // 부모 태그에도 error 클래스 추가. / 부모 태그에도 에러 양식 적용.
				return false; // 에러가 하나라도 있으면 전송되지 않도록 return false;
		} // error if end 
	}); // function end
}); // re end
</script>
<style type="text/css">
/* container 기본 양식 */
#container {
	width:600px;
	margin:0 auto;
	padding:20px;
	background:white;
}

h1 {
	margin-top:20px;
	font-size:large;
	color:#7CADB6;
}

dl dt {
	border-left:5px solid #7CADB6;
	border-bottom:1px solid #7CADB6;
	font-size:small;
	margin:0;
	padding:5px;
}

dl dt span { /* 필수 입력 요소 기호 양식을 span 태그로 묶어 폰트 형식 변경 */
	color:red;
	font-weight:bold;
}

dl dd {
	font-size:small;
	margin:0;
	padding:10px;
}

dl dd input {
	position:relative;
	z-index:2;
}

dl dd label {
	position:relative;
	padding:5px 5px 5px 25px;
	margin: 0 5px 0 -25px;
	margin-left:-25px;
	position:relative;
	z-index:1;
}

/* error 발생 시 폼 양식 */
dl dd.error input , 
dl dd.error textarea , 
dl dd.error label {
	background:#FFCCCC;
}

dl dd p.error {
	margin:0;
	color:red;
	font-weight:bold;
	margin-bottom:1em;
}
</style>
</head>
<body style="background:darkgray"> <!-- body에는 최대한 html 코드만 넣는다. -->
	<div id="container"> <!-- body에는 스타일을 부여할 수 없어 전체 내용을 중앙배치 할 수 있도록 div 태그 설정 -->
		<h1>문의하기</h1>
		<form action="complate.html" method="post"> <!-- 입력받을 공간: form / 전송 방식: post -->
			<dl>
				<dt>이름<span> ※ </span></dt> <!-- ※: 필수 표시. -->
					<dd><input type="text" name="name" size="80" class="validate required"/></dd>
				<!-- validate 클래스(유효성)이며, required(필수) 클래스이다. -->
				<dt>우편번호</dt>
					<dd><input type="text" name="zip" size="5" maxlength="5" class="validate number"/></dd>
				<!-- validate 클래스(유효성)이며, number 클래스(유효성)이다. -->
				<dt>이메일</dt>
					<dd><input type="text" value="" size="80" name="mail" class="validate mail"/></dd>
				<dt>이메일(확인)</dt>
					<dd><input type="text" value="" size="80" name="mail_check" class="validate mail mail_check"/></dd>
				<dt>성별<span> ※ </span></dt>
					<dd>
						<input type="radio" value="남자" name="gender" id="man" class="validate required" /> <label for="man">남자</label>
						<input type="radio" value="여자" name="gender" id="woman" /> <label for="woman">여자</label>
					</dd>
			<dt>사이트 정보를 얻은 곳은 어디입니까?<span> ※ </span></dt>
			<dd class="checkboxRequired">
				<input type="checkbox" name="search" id="search" value="검색엔진" /> <label for="search">검색엔진</label>
				<input type="checkbox" name="freiend" id="freiend" value="아는 사람 소개" /> <label for="freiend">아는 사람 소개</label>
				<input type="checkbox" name="mail_magazine" id="mail_magazine" value="메일 메거진" /> <label for="mail_magazine">메일 메거진</label>
				<input type="checkbox" name="etc" value="기타" id="etc" class="validate add_text" /> <label for="etc">기타</label>
				<!-- validate 클래스이며 add_text 클래스이다. -->
				<input type="text" name="etc_text" value="" /> <!-- 기타를 선택했다면 입력할 수 있도록 함. -->
			</dd>
			<dt> 문의 내용<span> ※ </span></dt>
				<dd> 
					<textarea id="inquiry" name="inquiry"rows="10" cols="60" class="validate required"></textarea>
				</dd>
		</dl>
		<p><input type="submit" value="송신"/></p>
		</form>
	</div>
</body>
</html>
