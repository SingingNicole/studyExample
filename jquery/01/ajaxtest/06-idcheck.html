<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>idcheck</title>
<link rel="stylesheet" type="text/css" href="css/reset.css"/>
<link rel="stylesheet" type="text/css" href="css/common.css"/>
<script src="http://code.jquery.com/jquery-3.6.1.min.js"></script>
<script>
	$(function() {
		$("#checkid").click(function() {
			let input_value = $("input[name='user_id']").val();
			
			if (!input_value) { // text에 공백("")값이 입력되었다면 false임을 활용
				alert("아이디를 입력하세요.");
				$("input[name='user_id']").focus(); // id 입력란에 focus
				return false(); // false를 return하고 함수 종료.
			}
			
			let url = "ajax/idcheck/idcheck.jsp"; // 웹 프로그래밍 연동(JSP)
			/* get 방식 활용하여 ajax 연동 */
			$.get(url, {"user_id" : input_value}, function(data) { // input_value에는 따옴표를 적으면 안 됨!!!!
				/* - xml 데이터를 읽어 왔을 때, 이 함수의 파라미터는 xml-dom이다.
				   - 데이터를 추출하는 방식은 $.ajax() 함수와 동일하다. */
				let result_text = $(data).find("result").text(); // 데이터 로드에 성공한 경우 xml에서 "result" 태그가 가지고 있는 값을 추출한다.
				let result = eval(result_text); // 가져 온 result 문자열을 boolean 값으로 바꾼다.
				
				if (result) { // result 값에 따른 결과 출력
					$(".console").html("<span style='color:blue'>사용할 수 있는 아이디입니다.</span>");
				} else {
					$(".console").html("<span style='color:red'>사용할 수 없는 아이디입니다.</span>");
				}
			},"xml");
		}); // click
	}); // ready
</script>
</head>
<body>
	<h1 class="title">아이디 중복 검사</h1>
	<div class="exec">
		<form>
			<input type="text" name="user_id"/>
			<input type="button" id="checkid" value="중복검사"/>
		</form>
	</div>
	<div class="console"></div>
</body>
</html>